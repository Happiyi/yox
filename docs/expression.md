表达式是所有模板语法的基础，没有一个优秀的表达式引擎，再好的模板语法都是空中楼阁。

Yox 内置了一个非常强大的表达式引擎，不仅支持常见的 `一元运算`，`二元运算` 和 `三元运算`，还支持 `基本类型字面量`、`数组字面量`、`对象字面量`、`数组索引访问`、`对象属性访问` 和 `函数调用`。

## 一元运算

```html
<div>
  {{+a}} {{-a}} {{~a}} {{!a}} {{!!a}}
</div>
```


## 二元运算

```html
<div>
  <!-- 数学计算 -->
  {{a + b}} {{a - b}} {{a * b}} {{a / b}} {{a % b}}

  <!-- 布尔比较 -->
  {{a > b}} {{a < b}}
  {{a >= b}} {{a <= b}}
  {{a == b}} {{a != b}}
  {{a === b}} {{a !== b}}
  {{a && b}} {{a || b}}

  <!-- 位运算 -->
  {{a & b}} {{a | b}} {{a ^ b}}

  <!-- 位移 -->
  {{a << b}} {{a >> b}} {{a >>> b}}
</div>
```


## 三元运算

```html
<div>
  {{a ? b : c}}
</div>
```


## 基本类型字面量

```html
<div>
  <!-- 数字 -->
  {{0}} {{1}}

  <!-- 字符串 -->
  {{'0'}} {{"1"}}

  <!-- 布尔 -->
  {{true}} {{false}}

  <!-- 空值 -->
  {{null}} {{undefined}}
</div>
```


## 数组字面量

```html
<div>
  {{[1, 2, 3]}}
</div>
```


## 对象字面量

```html
<div>
  <!--
    在 {{ 的右侧 和 }} 的左侧要打一个空格
    因为 {{{ 和 }}} 在模板语法中表示 “危险插值”，参考 模板 - 插值
  -->
  {{ { name: 'yox', age: 100 } }}
</div>
```


## 数组索引访问

```html
<div>
  {{users.0.name}}
</div>
```

> 不建议写 `users[0].name`，虽然能识别，但不符合 `Yox` 的风格


## 对象属性访问

```html
<div>
  {{user.name}}
  {{users[index].name}}
</div>
```

> 如果访问数组索引需要变量，必须使用 `[]`，这很 `JavaScript` 不是吗？


## 函数调用

函数调用有两种使用场景。

第一种是调用 `过滤器` 获得一个更符合需求的数据格式，比如格式化日期：

```html
<div>
  生日：{{formatDate(birthday)}}
</div>
```

> 更多内容，参考 **模板** - **过滤器**

第二种是在 `指令` 中调用 Yox 的实例方法，比如监听事件：

```html
<button on-click="submit()">
  Submit
</button>
```

> 更多内容，参考 **事件处理** - **调用方法**


除了 `指令` 可以调用 Yox 的实例方法，表达式中的其他函数调用都被视为调用 `filter`，举个例子：

```html
<div>
  {{name.toUpperCase()}}
</div>
```

你希望把 `name` 转换成大写格式，Yox 却认为你在调用名为 `name` 的工具库中的 `toUpperCase` 函数，最终能否正确输出，无关技术，纯靠人品。

`Yox` 没有采用 `{{name|upper}}` 形式的过滤器，它不够直观，尤其是多参数的场景，如下：

```html
<div>
  {{birthday|formatDate true false}}
</div>
```

参数之间到底应该用 `""` 还是 `","` 呢？不仅是语法设计者很难抉择，框架使用者也很迷茫，如下：

```html
<div>
  {{birthday|formatDate true, false}}
</div>
```

> 你觉得上面两个例子有什么明显不同吗？

我们认为它远没有调用函数简单直接，不信比比看：

```html
<div>
  {{formatDate(birthday, true, false)}}
</div>
```

如果你会 `JavaScript`，Yox 过滤器对你来说，学习成本为零。

## 全局函数

在 Yox 的模板中，你无法调用 `JavaScript` 环境存在的全局函数，如下：

```html
<div>
  <!-- parseInt 是无法调用到的，除非注册了 parseInt 过滤器 -->
  {{#if parseInt(a, 10) === 10}}
    a is 10
  {{/if}}
</div>
```

如果你不理解 Yox 的做法，大概也知道全局函数具体有哪些完全取决于浏览器厂商。

如果浏览器厂商新出了一个全局函数，在你没听过这个全局函数的情况下，看到模板里居然用了这个函数会是一种什么情景。

> 我们希望所有的函数调用都有迹可循，不是凭空出现，这样的开发模式才够严谨。

如果你喜欢 `lodash`，可以把它内置为全局过滤器，如下：

```js
Yox.filter('_', _)
```

```html
<div>
  {{_.toUpper(name)}}
</div>
```

如果你觉得 `_.toUpper` 看着别扭，还可以直接注册整个 `lodash` 对象，如下：

```js
Yox.filter(_)
```

```html
<div>
  {{toUpper(name)}}
</div>
```

> 友情提醒：这么做很容易命名冲突，请确定不会发生这种事。

## 无副作用

表达式的目的是求值，不应对原有数据造成任何改动，这就是为什么我们不支持 `a++`、`++a`、`a--`、`--a` 的原因。

> 如果你想通过表达式修改数据，唯一的方式是在调用的 `method` 中进行修改。


## 表达式 vs 语句

也许有人还分不清 `表达式` 和 `语句`，简单来说，`表达式` 会产生一个**值**，`语句` 则是表达一种**逻辑**，比如循环或条件。

Yox 只支持 `表达式`，不支持 `语句`，也就是说，下面这些示例全都不会生效：

```html
<div>
  <!-- 这是语句，不是表达式 -->
  {{var a = 1}}

  <!-- 这是语句，请使用 ok ? message : '' -->
  {{if (ok) { return message }}}
</div>
```