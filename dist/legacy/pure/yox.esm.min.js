const t=!0,e=!1,n=null,r=void 0,i="value",s="length",o="function",c="*",u=-1,f="undefined"!=typeof window?window:r,a=function(){},h=Object.freeze({}),l=Object.freeze([]),p="";function d(t){return t!==r}function g(t){return typeof t===o}function m(t){return Array.isArray(t)}function v(t){return t!==n&&"object"==typeof t}function y(t){return"string"==typeof t}function b(t){return"number"==typeof t}function w(t){return"boolean"==typeof t}function x(t){return b(t)||y(t)&&!isNaN(parseFloat(t))&&isFinite(t)}var $=Object.freeze({func:g,array:m,object:v,string:y,number:b,boolean:w,numeric:x});function E(t,e,n){if(g(t))return m(n)?t.apply(e,n):d(e)?t.call(e,n):d(n)?t(n):t()}class A{constructor(t,e){this.type=t,this.phase=A.PHASE_CURRENT,e&&(this.originalEvent=e)}preventDefault(){const e=this;if(!e.isPrevented){const{originalEvent:n}=e;n&&n.preventDefault(),e.isPrevented=t}return e}stopPropagation(){const e=this;if(!e.isStoped){const{originalEvent:n}=e;n&&n.stopPropagation(),e.isStoped=t}return e}prevent(){return this.preventDefault()}stop(){return this.stopPropagation()}}function C(t,n,r){const{length:i}=t;if(i)if(r)for(let r=i-1;r>=0&&n(t[r],r,i)!==e;r--);else for(let r=0;r<i&&n(t[r],r,i)!==e;r++);}function O(t,e){t[t.length]=e}function k(t,e){t.unshift(e)}function P(t,e,n){m(e)?C(e,function(e){n(t,e)}):n(t,e)}function j(t,e){P(t,e,O)}function R(t,e){P(t,e,k)}function z(t,n,r){let i=u;return C(t,function(t,s){if(r===e?t==n:t===n)return i=s,e}),i}function S(n,r,i){let s=0;return C(n,function(t,o){(i===e?t==r:t===r)&&(n.splice(o,1),s++)},t),s}function T(t,e,n){return z(t,e,n)>=0}function D(t){return!m(t)||!t.length}A.PHASE_CURRENT=0,A.PHASE_UPWARD=1,A.PHASE_DOWNWARD=u;var W=Object.freeze({each:C,push:j,unshift:R,indexOf:z,last:function(t){const{length:e}=t;if(e>0)return t[e-1]},pop:function(t){const{length:e}=t;if(e>0)return t.pop()},remove:S,has:T,toArray:function(t){return m(t)?t:E(l.slice,t)},toObject:function(t,e,n){let r={};return C(t,function(t){r[e?t[e]:t]=n||t}),r},join:function(t,e){return t.join(e)},falsy:D});const N=/-([a-z])/gi,_=/\B([A-Z])/g,U=/^[a-z]/,H={},I={},Y={};function L(t,e,n){return b(n)?e===n?p:t.slice(e,n):t.slice(e)}function M(t,e,n){return t.indexOf(e,d(n)?n:0)}function q(t,e,n){return t.lastIndexOf(e,d(n)?n:t.length)}function F(t,e){return 0===M(t,e)}function K(t,e){return t.charCodeAt(e||0)}function B(t){return t.toUpperCase()}function G(t){return t.toLowerCase()}function V(t,e){return M(t,e)>=0}function X(t){return!y(t)||!t.length}var Z=Object.freeze({camelize:function(t){return H[t]||(H[t]=t.replace(N,function(t,e){return B(e)})),H[t]},hyphenate:function(t){return I[t]||(I[t]=t.replace(_,function(t,e){return"-"+G(e)})),I[t]},capitalize:function(t){return Y[t]||(Y[t]=t.replace(U,B)),Y[t]},trim:function(t){return X(t)?p:t.trim()},slice:L,indexOf:M,lastIndexOf:q,startsWith:F,endsWith:function(t,e){const n=t.length-e.length;return n>=0&&q(t,e)===n},charAt:function(t,e){return t.charAt(e||0)},codeAt:K,upper:B,lower:G,has:V,falsy:X});const J=/\./g,Q=/\*/g,tt=/\*\*/g,et={},nt={},rt=".";function it(t,e){return t===e?e.length:F(t,e+=rt)?e.length:u}function st(t,n){const r=d(et[t])?et[t]:et[t]=t.split(rt);for(let t=0,i=r.length-1;t<=i&&n(r[t],t===i)!==e;t++);}function ot(t,e){let n=nt[e];if(!n){const t=e.replace(J,"\\.").replace(Q,"(\\w+)").replace(tt,"([.\\w]+?)");n=nt[e]=new RegExp(`^${t}$`)}const r=t.match(n);if(r)return r[1]}const ct={value:r};function ut(t){return Object.keys(t)}function ft(t,e){return t.length-e.length}function at(t,e){return e.length-t.length}function ht(t,e){return ut(t).sort(e?at:ft)}function lt(t,n){for(let r in t)if(n(t[r],r)===e)break}function pt(t){lt(t,function(e,n){delete t[n]})}function dt(t,e){return lt(e,function(e,n){t[n]=e}),t}function gt(t,e){let n=t;return m(t)?e?(n=[],C(t,function(t,r){n[r]=gt(t,e)})):n=t.slice():v(t)&&(n={},lt(t,function(t,r){n[r]=e?gt(t,e):t})),n}function mt(t,i){return st(i,function(i,s){if(t==n)return t=r,e;{let e=t[i],n=d(e);e&&g(e.get)&&(e=e.get()),s?n?(ct.value=e,t=ct):t=r:t=e}}),t}function vt(t,n,r,i){st(n,function(n,s){if(s)t[n]=r;else if(t[n])t=t[n];else{if(!i)return e;t=t[n]={}}})}function yt(t,e){return d(t[e])}var bt=Object.freeze({keys:ut,sort:ht,each:lt,clear:pt,extend:dt,merge:function(t,e){return t&&e?dt(dt({},t),e):t||e},copy:gt,get:mt,set:vt,has:yt,falsy:function(t){return!v(t)||m(t)||!ut(t).length}});function wt(t,e){return t!=n&&t.toString?t.toString():d(e)?e:p}const xt=1,$t=2,Et=3,At=4,Ct=5,Ot="undefined"!=typeof console?console:n,kt=/yox/.test(wt(a))?xt:Et,Pt="%c";function jt(){if(f){const t=f.YOX_LOG_LEVEL;if(t>=xt&&t<=Ct)return t}return kt}function Rt(t){return`background-color:${t};border-radius:12px;color:#fff;font-size:10px;padding:3px 6px;`}var zt=Object.freeze({DEBUG:xt,INFO:$t,WARN:Et,ERROR:At,FATAL:Ct,debug:function(t,e){Ot&&jt()<=xt&&Ot.log(Pt+(e||"Yox debug"),Rt("#999"),t)},info:function(t,e){Ot&&jt()<=$t&&Ot.log(Pt+(e||"Yox info"),Rt("#2db7f5"),t)},warn:function(t,e){Ot&&jt()<=Et&&Ot.warn(Pt+(e||"Yox warn"),Rt("#f90"),t)},error:function(t,e){Ot&&jt()<=At&&Ot.error(Pt+(e||"Yox error"),Rt("#ed4014"),t)},fatal:function(t,e){if(jt()<=Ct)throw new Error(`[${e||"Yox fatal"}]: ${t}`)}});class St{constructor(t){this.ns=t||e,this.listeners={}}fire(n,i,s){let o=this,{name:c,ns:u}=Tt(o.ns,n),f=o.listeners[c],a=t;if(f){f=gt(f);const t=i&&i[0]instanceof A?i[0]:r;C(f,function(c,h){if(!Nt(u,c)||!T(f,c)||s&&!s(n,i,c))return;t&&(t.listener=c.fn);let l=E(c.fn,c.ctx,i);return t&&(t.listener=r),c.num=c.num?c.num+1:1,c.num===c.max&&o.off(n,c.fn),t&&(l===e?t.prevent().stop():t.isStoped&&(l=e)),l===e?a=e:void 0})}return a}on(t,e){const n=this,{listeners:r}=n,i=g(e)?{fn:e}:e;if(v(i)&&g(i.fn)){const{name:e,ns:s}=Tt(n.ns,t);i.ns=s,j(r[e]||(r[e]=[]),i)}}off(e,n){const r=this,{listeners:i}=r;if(e){const{name:s,ns:o}=Tt(r.ns,e),c=Wt(n),u=function(e,n){C(e,function(t,n){c(t)&&Nt(o,t)&&e.splice(n,1)},t),e.length||delete i[n]};s?i[s]&&u(i[s],s):o&&lt(i,u)}else r.listeners={}}has(n,r){let{listeners:i}=this,{name:s,ns:o}=Tt(this.ns,n),c=t,u=Wt(r),f=function(t){return C(t,function(t){if(u(t)&&Nt(o,t))return c=e}),c};return s?i[s]&&f(i[s]):o&&lt(i,f),!c}}function Tt(t,e){const n={name:e,ns:p};if(t){const t=M(e,".");t>=0&&(n.name=L(e,0,t),n.ns=L(e,t+1))}return n}function Dt(e){return t}function Wt(t){return g(t)?function(e){return t===e.fn}:Dt}function Nt(e,n){const{ns:r}=n;return r&&e?r===e:t}function _t(t){return g(t)&&/native code/.test(wt(t))}let Ut;typeof setImmediate===o&&_t(setImmediate)&&(Ut=setImmediate);var Ht=Ut=typeof MessageChannel===o&&_t(MessageChannel)?function(t){const e=new MessageChannel;e.port1.onmessage=t,e.port2.postMessage(1)}:setTimeout;let It;class Yt{static shared(){return It||(It=new Yt)}constructor(){this.tasks=[]}append(t,e){const n=this,{tasks:r}=n;j(r,{fn:t,ctx:e}),1===r.length&&Ht(function(){n.run()})}prepend(t,e){const n=this,{tasks:r}=n;R(r,{fn:t,ctx:e}),1===r.length&&Ht(function(){n.run()})}clear(){this.tasks.length=0}run(){const{tasks:t}=this;t.length&&(this.tasks=[],C(t,function(t){E(t.fn,t.ctx)}))}}function Lt(t,e){return x(t)?+t:d(e)?e:0}class Mt{static build(e,n,r){let i,s,o=t,c=t,u=[];if(g(r)?i=r:v(r)&&(w(r.cache)&&(o=r.cache),w(r.sync)&&(c=r.sync),m(r.deps)&&(u=gt(r.deps)),g(r.get)&&(i=r.get),g(r.set)&&(s=r.set)),i)return new Mt(e,c,o,u,n,i,s)}constructor(e,n,r,i,s,o,c){const u=this;u.keypath=e,u.cache=r,u.deps=i,u.context=s.context,u.observer=s,u.getter=o,u.setter=c,u.unique={},u.watcher=function(n,r,i){const o=u.value,c=u.get(t);c!==o&&s.diff(e,c,o)},u.watcherOptions={sync:n,watcher:u.watcher},(u.fixed=!D(i))&&C(i,function(t){s.watch(t,u.watcherOptions)})}get(t){const e=this,{getter:n,context:r}=e;if(e.cache){if(t||!yt(e,i))if(e.fixed)e.value=E(n,r);else{e.unbind();const t=Mt.current;Mt.current=e,e.value=E(n,r),e.bind(),Mt.current=t}}else e.value=E(n,r);return e.value}set(t){const{setter:e,context:n}=this;e&&e.call(n,t)}add(e){this.unique[e]=t}bind(){const{unique:t,deps:e,observer:n,watcherOptions:r}=this;lt(t,function(t,i){j(e,i),n.watch(i,r)}),this.unique={}}unbind(){const{deps:e,observer:n,watcher:r}=this;C(e,function(t){n.unwatch(t,r)},t),e.length=0}}function qt(t,n){let r;return C(t,function(t){const i=it(n,t);if(i>=0)return r={name:t,prop:L(n,i)},e}),r}function Ft(t,e){if(t==n||e===p)return t;const r=mt(t,e);return r?r.value:void 0}function Kt(e,n,i,o,c){const u=function(t,n,r){if(n!==r){const u=(s=t,(i=e)&&s?i+rt+s:i||s);C(o,function(t){d(ot(u,t))&&c(t,u,n,r)}),Kt(u,n,r,o,c)}var i,s};(function(e,n,i){const o=y(e),c=y(n);if(o||c)return i(s,o?e.length:r,c?n.length:r),t})(n,i,u)||function(e,n,i){const o=m(e),c=m(n);if(o||c){const u=o?e.length:r,f=c?n.length:r;i(s,u,f);for(let t=0,s=Math.max(u||0,f||0);t<s;t++)i(""+t,e?e[t]:r,n?n[t]:r);return t}}(n,i,u)||function(t,e,n){const r=v(t),i=v(e);(r||i)&&(t=r?t:h,e=i?e:h,r&&lt(t,function(t,r){t!==e[r]&&n(r,t,e[r])}),i&&lt(e,function(e,r){e!==t[r]&&n(r,t[r],e)}))}(n,i,u)}function Bt(t,e,n,r,i,s){let o;lt(r,function(r,u){if(function(t){return V(t,c)}(u))return void(d(ot(t,u))?s(u,t,e,n):i&&(o?j(o,u):o=[u]));const f=it(u,t);if(f>=0){const t=L(u,f),r=Ft(e,t),i=Ft(n,t);r!==i&&s(u,u,r,i)}}),o&&Kt(t,e,n,o,s)}function Gt(t,e,n){if(n.count&&e)return n.count--,e[0]!==e[1]}const Vt={watcher:a};function Xt(e,n){return g(e)?(Vt.watcher=e,Vt.immediate=n===t,Vt):e&&e.watcher?e:void 0}class Zt{constructor(t,e){this.data=t||{},this.context=e||this,this.nextTask=new Yt,this.syncEmitter=new St,this.asyncEmitter=new St,this.asyncChanges={}}get(t,e,n){const r=Mt.current,{data:i,computed:s,reversedComputedKeys:o}=this;if(t===p)return i;let c,u;if(r&&!n&&r.add(t),s){if(u=s[t])return u.get();if(o){const e=qt(o,t);e&&e.prop&&(c=mt(s[e.name].get(),e.prop))}}return c||(c=mt(i,t)),c?c.value:e}set(t,e){const n=this,{data:r,computed:i,reversedComputedKeys:s}=n,o=function(t,e){const o=n.get(e);if(t===o)return;let c;if(i&&((c=i[e])&&c.set(t),s)){const n=qt(s,e);if(n&&n.prop&&(c=i[n.name])){const e=c.get();v(e)&&vt(e,n.prop,t)}}c||vt(r,e,t),n.diff(e,t,o)};y(t)?o(e,t):v(t)&&lt(t,o)}diff(e,n,i){const s=this,{syncEmitter:o,asyncEmitter:c,asyncChanges:u}=s,f=36!==K(e);Bt(e,n,i,o.listeners,f,function(t,e,n,r){o.fire(t,[n,r,e])}),Bt(e,n,i,c.listeners,f,function(e,n,i,o){C(c.listeners[e],function(t){t.count++});const{keypaths:f}=u[n]||(u[n]={value:o,keypaths:[]});T(f,e)||j(f,e),s.pending||(s.pending=t,s.nextTask.append(function(){s.pending&&(s.pending=r,s.diffAsync())}))})}diffAsync(){const t=this,{asyncEmitter:e,asyncChanges:n}=t;t.asyncChanges={},lt(n,function(n,r){const i=[t.get(r),n.value,r];C(n.keypaths,function(t){e.fire(t,i,Gt)})})}addComputed(e,n){const r=this,i=Mt.build(e,r,n);if(i)return r.computed||(r.computed={}),r.computed[e]=i,r.reversedComputedKeys=ht(r.computed,t),i}removeComputed(e){const n=this,{computed:r}=n;r&&yt(r,e)&&(delete r[e],n.reversedComputedKeys=ht(r,t))}watch(t,e,n){const i=this,{context:s,syncEmitter:o,asyncEmitter:c}=i,u=function(t,e){const n=e.sync?o:c,u={fn:e.watcher,ctx:s,count:0};e.once&&(u.max=1),n.on(t,u),e.immediate&&E(e.watcher,s,[i.get(t),r,t])};y(t)?u(t,Xt(e,n)):lt(t,function(t,e){u(e,Xt(t))})}unwatch(t,e){this.syncEmitter.off(t,e),this.asyncEmitter.off(t,e)}toggle(t){const e=!this.get(t);return this.set(t,e),e}increase(t,e,n){const r=Lt(this.get(t),0)+(e||1);if(!b(n)||r<=n)return this.set(t,r),r}decrease(t,e,n){const r=Lt(this.get(t),0)-(e||1);if(!b(n)||r>=n)return this.set(t,r),r}insert(n,r,i){let s=this.get(n);s=m(s)?gt(s):[];const{length:o}=s;if(i===t||i===o)s.push(r);else if(i===e||0===i)s.unshift(r);else{if(!(i>0&&i<o))return;s.splice(i,0,r)}return this.set(n,s),t}append(e,n){return this.insert(e,n,t)}prepend(t,n){return this.insert(t,n,e)}removeAt(e,n){let r=this.get(e);if(m(r)&&n>=0&&n<r.length)return(r=gt(r)).splice(n,1),this.set(e,r),t}remove(e,n){let r=this.get(e);if(m(r)&&S(r=gt(r),n))return this.set(e,r),t}copy(t,e){return gt(t,e)}destroy(){this.syncEmitter.off(),this.asyncEmitter.off(),this.nextTask.clear(),pt(this)}}class Jt{constructor(e){const n=this,r=e||h;n.$emitter=new St(t),r.events&&n.on(r.events);let{data:i,props:s,vnode:o,propTypes:c,computed:u,methods:f,watchers:a,extensions:l}=r;n.$options=r,l&&dt(n,l);const p=s?gt(s):{},d=n.$observer=new Zt(p,n);u&&lt(u,function(t,e){d.addComputed(e,t)});const m=g(i)?E(i,n,e):i;v(m)&&lt(m,function(t,e){p[e]=t}),f&&lt(f,function(t,e){n[e]=t}),function(t,e){e&&t.watch(e)}(n,a)}static use(t){t.install(Jt)}static create(t){return t}static nextTick(t,e){Yt.shared().append(t,e)}static compile(t,e){return p}static directive(t,e){}static transition(t,e){}static component(t,e){}static partial(t,e){}static filter(t,e){}addComputed(t,e){return this.$observer.addComputed(t,e)}removeComputed(t){this.$observer.removeComputed(t)}get(t,e,n){return this.$observer.get(t,e,n)}set(t,e){const{$observer:n}=this;n&&n.set(t,e)}on(t,e){return te(this,t,e)}once(e,n){return te(this,e,n,t)}off(t,e){return this.$emitter.off(t,e),this}fire(e,n,r){let i,s=this,o=e instanceof A?e:new A(e),c=[o];if(o.target||(o.target=s),v(n)?j(c,n):n===t&&(r=t),i=s.$emitter.fire(o.type,c)){const{$parent:e,$children:c}=s;r?c&&(o.phase=A.PHASE_DOWNWARD,C(c,function(e){return i=e.fire(o,n,t)})):e&&(o.phase=A.PHASE_UPWARD,i=e.fire(o,n))}return i}watch(t,e,n){return this.$observer.watch(t,e,n),this}unwatch(t,e){return this.$observer.unwatch(t,e),this}loadComponent(t,e){}createComponent(t,e){return this}directive(t,e){}transition(t,e){}component(t,e){}partial(t,e){}filter(t,e){}forceUpdate(t){}render(){}update(t,e){}checkProps(t){}checkProp(t,e){}destroy(){const{$parent:t,$options:e,$emitter:n,$observer:r}=this;r.destroy(),n.off(),pt(this)}nextTick(t){this.$observer.nextTask.append(t,this)}toggle(t){return this.$observer.toggle(t)}increase(t,e,n){return this.$observer.increase(t,e,n)}decrease(t,e,n){return this.$observer.decrease(t,e,n)}insert(t,e,n){return this.$observer.insert(t,e,n)}append(t,e){return this.$observer.append(t,e)}prepend(t,e){return this.$observer.prepend(t,e)}removeAt(t,e){return this.$observer.removeAt(t,e)}remove(t,e){return this.$observer.remove(t,e)}copy(t,e){return this.$observer.copy(t,e)}}function Qt(t,e,n,r){const i={fn:n,ctx:t};r&&(i.max=1),t.$emitter.on(e,i)}function te(t,e,n,r){return y(e)?Qt(t,e,n,r):lt(e,function(e,n){Qt(t,n,e,r)}),t}Jt.version="1.0.0-alpha.78",Jt.is=$,Jt.array=W,Jt.object=bt,Jt.string=Z,Jt.logger=zt,Jt.Event=A,Jt.Emitter=St;export default Jt;
//# sourceMappingURL=yox.esm.min.js.map
